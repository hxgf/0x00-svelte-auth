var a={formbody_encode:function(e){return Object.entries(e).map(([t,o])=>t+"="+o).join("&")},cookie_get:function(e){let o=`; ${document.cookie}`.split(`; ${e}=`);if(o.length===2)return o.pop().split(";").shift()},cookie_parse:function(e){return e.split(";").map(t=>t.split("=")).reduce((t,o)=>(t[decodeURIComponent(o[0].trim())]=decodeURIComponent(o[1].trim()),t),{})},jwt_parse:function(e){var t=e.split(".")[1],o=t.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(o).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)},api_xhr:function(e){e.data=e.data||{},e.authenticated&&this.cookie_get("auth_token")&&(e.data.auth_token=this.cookie_get("auth_token"));var t=new XMLHttpRequest;return t.open("POST",e.url,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.onload=function(){if(this.status>=200&&this.status<400)if(e.callback)e.callback(JSON.parse(this.response));else return e.debug&&console.log(JSON.parse(this.response)),this.response;else alert(`Request error: ${this.response}`)},t.onerror=function(){alert(`Network error: ${this.response}`)},t.send(this.formbody_encode(e.data))},api_fetch:function(e){e.authenticated&&this.cookie_get("auth_token")&&(e.data.auth_token=this.cookie_get("auth_token"));let t={method:e.method?e.method:"POST",headers:{"Content-type":e.json?"application/json":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"}};if(e.method==="GET"){let o=new URLSearchParams(e.data).toString();e.url=e.url+"?"+o}else t.body=e.json?JSON.stringify(e.data):this.formbody_encode(e.data);return fetch(e.url,t).then(o=>o.json()).catch(o=>{alert(`Network error: ${o}`),console.log(o)})},serialize:function(e){for(var t=[],o=0;o<e.elements.length;o++){var r=e.elements[o];if(!(!r.name||r.disabled||r.type==="file"||r.type==="reset"||r.type==="submit"||r.type==="button"))if(r.type==="select-multiple")for(var n=0;n<r.options.length;n++)!r.options[n].selected||t.push(encodeURIComponent(r.name)+"="+encodeURIComponent(r.options[n].value));else(r.type!=="checkbox"&&r.type!=="radio"||r.checked)&&t.push(encodeURIComponent(r.name)+"="+encodeURIComponent(r.value))}return t.join("&")},listener_clear_error:function(){document.addEventListener("focusout",function(e){var t=e.target;t.parentNode.classList.contains("error")&&t.value&&t.parentNode.classList.remove("error")})},form_validate_required:function(e){document.body.classList.add("working");for(var t=document.querySelectorAll(".required input, .required textarea, .required select"),o=!0,r=0;r<t.length;r++){var n=t[r];n.value||(n.parentNode.classList.add("error"),o=!1)}o?e():(a.listener_clear_error(),document.body.classList.remove("working"),smoke.alert("Required information is missing."))}};export{a as d};
